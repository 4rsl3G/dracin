<%
  const d = data?.detail || {};
  const id = String(d.shortPlayId || '');
  const name = d.shortPlayName || '';
  const cover = d.shortPlayCover || '';
  const intro = d.shotIntroduce || '';
  const total = d.totalEpisode || 0;
  const isFinish = d.isFinish === 1;
  const eps = Array.isArray(d.shortPlayEpisodeInfos) ? d.shortPlayEpisodeInfos : [];
%>

<section class="ps-detail-hero ps-detail-hero-v2 ps-lazy-bg" data-bg="<%= cover %>" data-aos="fade-up">
  <div class="ps-detail-scrim ps-detail-scrim-v2"></div>

  <div class="ps-detail-inner ps-detail-inner-v2">
    <div class="ps-detail-top">
      <div class="ps-detail-meta" data-aos="fade-up" data-aos-delay="80">
        <div class="ps-detail-pill ps-pill-v2"><%= isFinish ? 'Tamat' : 'On-going' %></div>
        <div class="ps-detail-pill ps-pill-v2"><%= total %> Episode</div>
      </div>

      <h1 class="ps-detail-title ps-detail-title-v2" data-aos="fade-up" data-aos-delay="140"><%= name %></h1>

      <% if (intro) { %>
        <p class="ps-detail-intro ps-detail-intro-v2" data-aos="fade-up" data-aos-delay="200"><%= intro %></p>
      <% } %>

      <% if (eps.length) { const first = eps[0]; %>
        <div class="ps-detail-actions ps-detail-actions-v2" data-aos="fade-up" data-aos-delay="260">
          <a class="ps-btn ps-btn-accent ps-btn-accent-v2" href="/watch/<%= id %>/<%= first.episodeId %>">
            <i class="ri-play-fill"></i><span>Mulai Episode 1</span>
          </a>
          <button class="ps-btn ps-btn-ghost ps-btn-ghost-v2" id="psCopyLink">
            <i class="ri-link-m"></i><span>Bagikan</span>
          </button>
        </div>
      <% } %>

      <div class="ps-detail-stats" data-aos="fade-up" data-aos-delay="320">
        <div class="ps-stat">
          <div class="ps-stat-k">Status</div>
          <div class="ps-stat-v"><%= isFinish ? 'Tamat' : 'Berjalan' %></div>
        </div>
        <div class="ps-stat">
          <div class="ps-stat-k">Total</div>
          <div class="ps-stat-v"><%= total %> eps</div>
        </div>
        <div class="ps-stat">
          <div class="ps-stat-k">Mode</div>
          <div class="ps-stat-v">Portrait</div>
        </div>
      </div>
    </div>
  </div>

  <div class="ps-detail-glass" aria-hidden="true"></div>
</section>

<section class="ps-episodes ps-episodes-v2" data-aos="fade-up">
  <div class="ps-episodes-head ps-episodes-head-v2">
    <div>
      <h2 class="ps-episodes-title ps-episodes-title-v2">Episode</h2>
      <div class="ps-episodes-sub ps-episodes-sub-v2">Scroll cepat â€¢ Virtual list</div>
    </div>

    <div class="ps-chip" data-aos="fade-up" data-aos-delay="120">
      <i class="ri-flashlight-fill"></i>
      <span>Optimized</span>
    </div>
  </div>

  <div class="ps-episode-rail ps-episode-rail-v2" id="psEpisodeRail">
    <div class="ps-episode-spacer" id="psEpisodeTopSpacer"></div>
    <div class="ps-episode-window" id="psEpisodeWindow"></div>
    <div class="ps-episode-spacer" id="psEpisodeBottomSpacer"></div>
  </div>

  <script>
    window.__PANSTREAM__ = window.__PANSTREAM__ || {};
    window.__PANSTREAM__.detail = <%- JSON.stringify({
      shortPlayId: d.shortPlayId,
      shortPlayName: d.shortPlayName,
      shortPlayCover: d.shortPlayCover,
      shotIntroduce: d.shotIntroduce,
      totalEpisode: d.totalEpisode,
      isFinish: d.isFinish,
      shortPlayEpisodeInfos: eps
    }) %>;
  </script>
</section>
